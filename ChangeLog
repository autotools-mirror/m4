2000-01-10  Rene' Seindal  <rene@seindal.dk>

	* Prerelease 1.4o.

	* TODO, NEWS: Cleaned up and updated.

	* src/m4.c (main): New variable exit_status for exit status in
	case of unreadable files.  Now m4 will exit with EXIT_FAILURE if a
	file cannot be read instead of EXIT_SUCCESS.

	* src/builtin.c (m4_indir): Changed error message to help
	translators (from Akim Demaille <demaille@inf.enst.fr>). 

	* lib/obstack.[hc], getopt*.[ch]: Updated to newest version from
	Cygnus.

	* lib/error.[hc], lib/regex.[hc], lib/strtol.c: Updated to version
	from glic 2.1.2.

	* src/input.c (match_input): Reordering of code, to avoid multiple
	calls to push_string_init() from obstack_grow(), which can happen
	with some compilers (found and fixed by James Bonfield
	<jkb@mrc-lmb.cam.ac.uk>).

	* src/stackovf.c: Added prototypes for ultrix.
	(setup_stackovf_trap): Added __P to cast.
	(Both reported by John David Anglin <dave@hiauly1.hia.nrc.ca>)

2000-01-09  Rene' Seindal  <rene@seindal.dk>

	* doc/m4.texinfo (Changequote): Added comment about changing
	quotes when the old quote is a part of the new.

	* src/builtin.c (expand_ranges): Added break after trailing dash.
	This caused misbehavious on some systems (found and fixed by Akim
	Demaille <demaille@inf.enst.fr>).

	* AUTHORS: Thomas Tanner included

	* acconfig.h: Added entry for ss_sp (see below).

	* configure.in (use_stackovf): Added check for stack_t with member
	ss_base instead of ss_sp (BSDI notably).  (Reported by Paul Eggert
	<eggert@twinsun.com>).

	* doc/m4.texinfo (Frozen files): Added a simpler example for
	generating frozen files from several input files.

1999-11-14  Paul Eggert  <eggert@twinsun.com>

        * po/POTFILES.in: Add lib/getopt.c, lib/obstack.c,
        lib/regex.c, lib/xmalloc.c.

1999-11-10  Rene' Seindal  <rene@seindal.dk>

	* Makefile.am (ACLOCAL_AMFLAGS): Passes -I acm4 to aclocal.

	* src/module.c: reindented.
	(module_load): return if this is a repeated load of same module.
	(module_init): slight change of logic to avoid repeated
	initialisation debug messages.

	* Makefile.am (DIST_SUBDIRS): Added to ensure modules/ is included
	in the distribution.

	* modules/Makefile.am (test_la_LDFLAGS): set to -module to silence
	automake warnings about missing lib prefix.
	(time_la_LDFLAGS): ditto
	(stdlib_la_LDFLAGS): ditto

1999-11-10  Paul Eggert  <eggert@twinsun.com>

        * src/m4.h: Include error.h, since our macros use error.
        * src/m4.c: Don't need to include error.h.

1999-11-09  Paul Eggert  <eggert@twinsun.com>

        * src/m4.h (voidstar): Define to void * if __STDC__ is defined
        and zero, as Solaris 7 cc does.
        (bcopy): Remove macro; no longer needed with new obstack.h.

        * src/output.c (freeze_diversions): Don't assume that a
        diversion size can fit in `int'.  Check for diversion file
        size too large to be printed with `unsigned long'.

        * src/Makefile.am (CFLAGS): Omit -Wall.

        * src/stackovf.c (setup_stackovf_trap): Remove cast to unsigned.

        * src/debug.c (trace_format):
        Use ANSI C if (defined __STDC__ && __STDC__) || defined PROTOTYPES.

        * src/freeze.c (produce_frozen_state):
        Don't assume string lengths fit in int.

1999-10-13  Rene' Seindal  <rene@seindal.dk>

	* configure.in (ALL_LINGUAS): Added Greek translation (el).
	(ALL_LINGUAS): Added Czech translation (cs).

1999-03-30  Gary V. Vaughan  <gvaughan@oranda.demon.co.uk>

	* src/builtin.c: moved module loading functions into...
	* src/module.c: entirely new implementation using libltdl.
	* po/POTFILES.in: added src/module.c.
	* modules/Makefile.am (LTLIBRARIES): Removed lib prefix as these
	are modules, not linktime libraries.
	(LDFLAGS): added -no-undefined -module and -avoid-version flags.
	* modules/stdlib.c (m4_macro_table): use <name>_LTX collision
	avoidance on exported symbols.
	* modules/test.c (m4_macro_table, m4_init_module,
	m4_finish_module): ditto.
	* modules/time.c (m4_macro_table): ditto.

	* modules/time2.m4: new file which requires command line loading
	of modules.
	* src/m4.c (--load-module): dynamically load named runtime module
	into running executable before reading the source.
	(--module-directory): prepend a directory to the module search
	path.
	(module_init()): Do this the first time we load a module instead;
	if the module subsystem is broken normal m4 scripts can still run.
	* src/m4.h (install_builtin_table): is now exported.
	
1999-03-26  Gary V. Vaughan  <gvaughan@oranda.demon.co.uk>

	* src/module.c: removed.  No longer required.
	* po/POTFILES.in: removed src/module.c.
	
	* Makefile.am (MAINTAINERCLEANFILES): Remove all the files that
	the bootstrap script can recreate.
	* acm4/Makefile.am (MAINTAINERCLEANFILES): ditto.
	* doc/Makefile.am (MAINTAINERCLEANFILES): ditto.
	* examples/Makefile.am (MAINTAINERCLEANFILES): ditto.
	* lib/Makefile.am (MAINTAINERCLEANFILES): ditto.
	(AUTOMAKE_OPTIONS): reduced strictness to allow COPYING.LIB.
	* modules/Makefile.am (MAINTAINERCLEANFILES): ditto.
	* src/Makefile.am (MAINTAINERCLEANFILES): ditto.
	* tests/Makefile.am (MAINTAINERCLEANFILES): ditto.
	
	* acinclude.m4: removed.  `aclocal -I acm4' handles this much
	better.
	* acm4/Makefile.am (ACINCLUDE_M4): ditto.
	* acm4/gettext.m4: removed.  It causes a multiple definition vs.
	the installed gettext.m4 file when running aclocal.
	
1999-03-25  Gary V. Vaughan  <gvaughan@oranda.demon.co.uk>

	* configure.in (AM_INIT_AUTOMAKE): bumped version number to
	distinguish this from the last prerelease.
	(AC_LIBLTDL_CONVENIENCE):  build libltdl as a convenience library
	in its own subdirectory.
	
	* modules/Makefile.am (*_SOURCES): renamed to use libtool's "no
	lib prefix on a module" feature.
	(LDFLAGS): Added `-module -avoid-version' flags to build
	versionless module libraries.
	* src/builtin.c (m4_load_module): use libltdl.
	(module_unload_all): use libltdl.
	* src/m4.c (module_init): initialise module loading on demand for
	better diagnostics, and so that m4 will still work even if
	the module code is broken.
	* src/m4.h (module_init): removed.  No longer relevant.
	* modules/stdlib.c (m4_macro_table): use stdlib_LTX_ prefix on
	exported symbols for compatibility with dlpreopening.
	* modules/test.c (m4_macro_table, m4_init_module,
	m4_finish_module): ditto.
	* modules/time.c (m4_macro_table): ditto.
	
	* bootstrap: New file.  Runs all the autoutils in the right order
	after a fresh checkout, or a make maintainer-clean.

1999-02-18  Akim Demaille  <demaille@inf.enst.fr>

	* src/builtin.c (dump_symbols): New function, factorising common
	content of m4_dumpdef and m4_symbols.
	(m4_dumpdef): Use it.
	(m4_symbols): New function, implementing `symbols'.  Use it.
	* doc/m4.texinfo: Fixed missing commas after @xref, so that the
 	file compile with modern makeinfo.
	(Symbols): New node, documenting symbols.
	(direntry): Modernize.

	
1998-12-11  Rene' Seindal  <rene@seindal.dk>

	* src/builtin.c (predefined_tab): New predefined macros
	__m4_changeword__, __m4_gmp__ and __m4_modules__ for testing for
	configure time options.

1998-12-01  Andreas Schwab  <schwab@issan.cs.uni-dortmund.de>

        * src/module.c (module_try_load): Don't try to be clever and
        overwrite argument string.  Instead allocate all constructed
        strings locally, since they can have arbitrary lengths.  Make
        arguments pointers to const.
        (module_search): Simplify due to above change.

1998-11-29  Rene' Seindal  <rene@seindal.dk>

	* Prerelease 1.4n.

	* tests/Makefile.am (OTHER_TESTS, OTHER_FILES): New tests.

	* tests/other-tests/import-environment.{m4,test}: New test.

	* tests/other-tests/discard-comments.{m4,test}: New test.

	* doc/m4.texinfo (Invoking m4): Updated for --discard-comments.

	* src/m4.c (main): New option -c --discard-comments.
	New global variable discard_comments.

	* src/m4.h (token_type): New TOKEN_NONE for tokens to be
	discarded, ie never returned from next_token().
	Added declaration of discard_comments.

	* src/input.c (next_token): Now loops until token type is not
	TOKEN_NONE.  Comments are now given this type when comments should
	be discarded.

	* doc/m4.texinfo (Invoking m4): Updated for --import-environment
	and mpeval.

1998-11-28  Rene' Seindal  <rene@seindal.dk>

	* src/m4.c (main): New option --import-environment (no single
	letter option).

	* When configured with --with-gmp both the normal (fast) eval()
	and the gmp aware mpeval() are defined.  To restore previous
	bahaviour use "define(`eval', defn(`mpeval'))".

	* tests/other-tests/gmp.m4: Changed to use mpeval().

	* src/evalmp.c: New file for compiling eval.c as gmp aware.
	Just defines USE_GMP if WITH_GMP is defined and includes eval.c.

	* src/eval.c: Now includes "numb.c" directly.  Everything in this
	file must by static, except evaluate(), which is changed to
	mp_evaluate() if USE_GMP in force.

	* src/numb.c: Changed to be included by eval.c instead of being
	compiled separately.  Everything is declared static.

	* src/numb.h: Removed declarations of functions, as numb.c is now
	included by eval.c.

	* src/builtin.c: Declaration of m4_mpeval() added.
	Inserted `mpeval' in builtin table.
	(do_eval): New function with common code for m4_eval and m4_mpeval.
	(m4_mpeval): New function for gmp version of eval.

	* src/m4.h: Declaration of mp_evaluate().

	* src/Makefile.am (m4_SOUCES): Includes mpeval.c.
	(EXTRA_m4_SOURCES): Now has numb.c and numb.h

	* src/m4.c (main): m4 --version also shows which options were used
	for compilation, such as: "GNU m4 1.4n (options: modules gmp)"

1998-11-27  Rene' Seindal  <rene@seindal.dk>

	* Error messages now always print program name before input file
	name as specified by GNU coding standards.  Reported by Akim
	Demaille <demaille@inf.enst.fr>.

	* doc/m4.texinfo (Include): Change due to changed error message
	format.
	(Eval): Do.

	* tests/get-them: Minor change to sed script due to changed error
	message format.

	* src/m4.c (print_program_name): New func used to print program
	name, input file and line number in error ().  Used as an
	error_print_progname handler.
	(reference_error): Removed.
	(main): Assigns error_print_progname.

	* src/m4.h (M4ERROR): Removed reference_error ().

1998-11-25  Rene' Seindal  <rene@seindal.dk>

	* Updated to libtool 1.2b.

	* src/builtin.c (install_builtin_table): Added braces to avoid
	warning of ambiguous 'else'.

	* src/module.c: Inserted search path code from path.c modified to
	use new interface.
	(module_init): Configured default path used only if M4MODPATH is
	not set.
	(module_try_load): Now reads libMODULE.la as generated by libtool
	for actual module name.
	(module_load): Gives better error messages on failure.

	* src/m4.h: Added declarations of structures and functions for
	generic search path handling.

	* src/path.c: Removed all module specific code and introduced new
	functions of more generic search path handling.

1998-11-24  Rene' Seindal  <rene@seindal.dk>

	* configure.in: Defines INTLINCL to -I$(top_srcdir)/intl if using
	included gettext, as <libintl.h> might not be found
	otherwise. Reported by Andrew Bettison <andrewb@zip.com.au>.

1998-11-22  Rene' Seindal  <rene@seindal.dk>

	* src/output.c (insert_diversion): Fixed bug that might cause m4
	to read from standard output!  Triggered by input
	'divert(1)undivert(0)'.  Test for divnum>0 changed to divnum>=0,
	so now 'undivert(0)' does nothing.

1998-11-18  Rene' Seindal  <rene@seindal.dk>

	* Prerelease 1.4m.

	* src/input.c (set_word_regexp): Fixed a bug, where word_regexp
	could be changed when compiling a illegal regexp, causing later
	use of the regexp to dump core.

	* src/module.c (module_load): Changed error message to conform to
	standards. 

	* src/m4.c (usage): Added message about reporting bugs.

	* doc/m4.texinfo (Changeword): Corrected a wrong example.
	(Changeword): Added note about the type of regexps used.

	* ltconfig, ltmain.sh: New files from Libtool 1.2.

	* configure.in: Added calls to AM_ENABLE_SHARED, AM_DISABLE_STATIC
	and AM_PROG_LIBTOOL.

	* acm4/modules.m4 (AM_WITH_MODULES): Redone completely to work
	with libtool.

	* modules/Makefile.am: Changed completely to compile modules using
	libtool.  The modules are compiled as shared libraries, and are
	renamed when installed.

	* src/m4.h, src/module.c, acm4/modules.m4, acconfig.h: Renamed
	USE_SHL_LOAD to HAVE_SHL_LOAD

	* src/builtin.c (shipout_string): Now tests for a NULL string.

	* src/module.c: New level of indirection around non-portable
	functions to load shared objects.  Intended to encapsulate the non
	portable parts better and to reduce the number of #ifdefs in the
	code.

	* Makefile.am (DIST_SUBDIRS): Instead of EXTRA_DIST for added
	directory modules/ to the distribution.

1998-11-15  Rene' Seindal  <rene@seindal.dk>

	* Prerelease 1.4l.

	* modules/stdlib.c: New module `stdlib' defining some standard
	functions: getcwd, getlogin, getpid, getppid, getuid, getpwnam,
	getpwuid, hostname, rand, srand, getenv, setenv, unsetenv, uname.
	
	* src/builtin.c (shipout_string): New convenience function for
	builtins and modules.

	* src/module.c (module_load): Tentative support for
	shl_load/shl_findsym, but I cannot test it.  Copied from MetaHTML.

	* Makefile.am (SUBDIRS): Directory modules added if configured.

	* modules/Makefile.am: Now correctly compiles and installs
	modules in pkglibexecdir.

	* src/m4.h: WITH_MODULES defined iff HAVE_DLOPEN or USE_SHL_LOAD.
	These two are now initialised by autoconf macros.

	* src/path.c (module_env_init): MODULE_PATH is always on the
	search path.

	* src/Makefile.am: Now generated pathconf.h which defined the
	default MODULE_PATH.

	* configure.in (pkglibexecdir): Added defintion of pkglibexecdir,
	where modules are installed.

	* acm4/modules.m4: Enhanced with code from MetaHTML, contributed
	by Brian J. Fox <bfox@datawave.net>.  This change allow modules to
	build and install automatically, and it is prepared for other
	interfacec than dlopen().

	* src/builtin.c (predefined_tab): Added __m4_version__ for the
	current version of GNU m4.  It is a GNU extension.

1998-11-14  Rene' Seindal  <rene@seindal.dk>

	* tests/Makefile.am (GENERATED_TESTS): Added new
	generated-tests/changesy.8.test
	
	* doc/m4.texinfo (Changesyntax): Documentation for escape
	syntax class.

	* src/macro.c (expand_token): Check for escaped macro call before
	symbol table lookup.

	* src/builtin.c (m4_changesyntax): Added `@' flag to define escape
	characters

	* src/input.c: New static variable use_macro_escape, which is TRUE
	iff some character has code SYNTAX_ESCAPE
	(input_init): Added initialisation of use_macro_escape.
	(check_use_macro_escape): New function to synchronise
	use_macro_escape with the syntax table.
	(set_quotes): Added call to check_use_macro_escape()
	(set_comment): Do.
	(set_syntax): Do.
	(next_token): Added new case for IS_ESCAPE.

	* src/m4.h (SYNTAX_ESCAPE): Defined as simple syntax category.

1998-10-13  René Seindal  <rene@seindal.dk>

	* Prerelease 1.4k.

	* tests/Makefile.am (GENERATED_TESTS): Renamed gentest to
	generated-tests. 

	* tests/Makefile.am (OTHER_TESTS, OTHER_FILES): Added manually
	maintained tests in tests/other-tests.  These currently tests for
	8-bit transparency, multiple precision arithmetic and sync-line
	output.  Test for stackoverflow detection does not work.

	* examples/Makefile.am (TESTS): Added tests for all example files.

	* examples/mktests.sh: New file.  Help program for creating test
	files. 

	* tests/mkconfig.sh: New file to generate tests/config.m4 and
	tests/config.sh.  This is for tests of configure selectable
	features.  Picks up all set WITH_ and ENABLE_ veriables from
	config.h

	* src/path.c (path_search): Added argument 'char **expanded_name'
	to return the expanded name.

	* src/m4.h: Added 2nd argument to declaration of path_search().

	* src/m4.c (main): Added 2nd argument to path_search().

	* src/freeze.c (reload_frozen_state): Do.

	* src/builtin.c (m4_undivert): Do.
	(include): Do.

1998-10-11  René Seindal  <rene@seindal.dk>

	* acm4/Makefile.am (ACINCLUDES_M4): Added gmp.m4 and modules.m4

	* acm4/modules.m4: New file.  Defines AM_WITH_MODULES.

	* acm4/gmp.m4: New file.  Defines AM_WITH_GMP.

	* configure.in: Introduced AM_WITH_MODULES and AM_WITH_GMP.

	* AUTHORS, ChangeLog: Changed all dates to ISO 8601.

	* intl/: Updated to GNU gettext 0.10.35.

	* doc/m4.texinfo (Format): Documented that format is blind.

	* src/builtin.c (builtin_tab): Builtin format marked as blind.

1998-10-07  René Seindal  <rene@seindal.dk>

	* Prerelease 1.4j.

	* tests/Makefile.am (GENERATED_TESTS): Changed .m4 extension to
	.test, as the files are no longer just m4 input.

	* tests/get-them (FILE): Changed .m4 extension to .test.

	* src/m4.h (token_type): New token type TOKEN_SPACE introduced.
	Otherwise quoted strings with leading whitespace first in a macro
	argument would be eliminated.

	* src/macro.c (expand_token): Handles new token type TOKEN_SPACE.
	(expand_argument): Do.

	* src/input.c (next_token): SPACE and NUM/OTHER characters are only
	grouped together iff both quote and comment strings are single
	character.  Otherwise they might include a comment/quote leader.
	(next_token): Returns new token type TOKEN_SPACE.

	* src/builtin.c (push_builtin_table): New function to push a
	builtin_table on the stack without installing its contents.
	(find_builtin_by_name): Added call to push_builtin_table() if
	reading frozen files.  Otherwise the builtins named in the frozen
	files could not be found.
	(install_builtin_table): Changed to use push_builtin_table()

1998-10-04  René Seindal  <rene@seindal.dk>

	* Prerelease 1.4i.

	* configure.in (ALL_LINGUAS): Added Polish pl.po

1998-10-03  René Seindal  <rene@seindal.dk>

	* Many files: Incorporated changes to implement dynamic modules.
	Detailed comments in src/modules.c and modules/README

	* src/module.c: New file, implements the OS dependant parts of
	dynamic module loading.

	* src/Makefile.am (m4_SOURCES): Added module.c

	* src/builtin.h: New file, declares some functions from builtin.c
	that are of use for other modules (shipout_int, numeric_arg,
	skip_space, bad_argc), and the macros ARG() and DECLARE().

	* src/builtin.c (install_builtin_table): New function.  Each
	module brings in a builtin_table, which is pushed on a stack.
	(struct builtin_table): New struct for list of builtin_tables.
	(m4_loadmodule): New function to implement builtin "loadmodule".
	(shipout_int): No longer static, to be used by modules.
	(numeric_arg): do.
	(skip_space): do.
	(bad_argc): do.
	(builtin_init): changed to call install_builtin_table()
	(find_builtin_by_name): Now searches all builtin_tables
	(find_builtin_by_addr): do.

	* src/path.c: Reorganised to allow for two search paths, one for
	include files and one for modules.

	* src/m4.h: Added declarations for new functions in module.c and
	in path.c.

	* src/m4.c (main): Added call to module_init().

	* modules: New directory with a few demo modules.

	* Makefile.am (EXTRA_DIST): Added modules/* since modules/ is not
	in SUBDIRS.

	* configure.in: Added modules/Makefile to AC_OUTPUT.

	* configure.in: Added code to implement --with-modules.  Tests for
	<dlfcn.h> and -ldl.

	* acconfig.h: Added WITH_MODULES

1998-10-02  René Seindal  <rene@seindal.dk>

	* examples/Makefile.am (pkgdata_DATA): Removed special target for
	check and variables TESTS.  These tests are now run from the
	tests/ directory.

	* tests/Makefile.am (OTHER_TESTS): Added tests from the example/
	directory.  The files stay there but the tests are run from the
	tests/ directory.

	* tests/Makefile.am (EXTRA_DIST): Added run-test.

	* tests/run-test: New file.  Run a test manually

	* tests/Makefile.am, tests/get_them: Moved automatically generated
	tests (from the manual) to sub directory tests/gentest/.  The
	tests/ directory had gotten a bit messy.

1998-09-06  Erick Branderhorst  <Erick.Branderhorst@asml.nl>

	* examples/{comments,ddivert,debug,iso8859,reverse,sysv-args,\
	wrap}.test: Added a few testcases.

1998-08-21  Erick Branderhorst  <Erick.Branderhorst@asml.nl>

	* Prerelease 1.4h.

	* lib/Makefile.am (noinst_HEADERS): regex.h added

	* configure.in (jm_WITH_REGEX, jm_PREREQ_ERROR):
	acm4/{error,regex}.m4 (from fileutils-3.16u.tar.gz).

	* acm4/Makefile.am: created providing rules to create
	$(top_srcdir)/acinclude.m4 to be used by aclocal.

	* tests/defs (LANGUAGE, LC_ALL, LANG): force them to be
	`C'. Reported by Ulrich Drepper.

	* Makefile.am (SUBDIRS): Removed checks directory
	* configure.in (AC_OUTPUT): Removed checks/Makefile

	* doc/m4.texinfo (Patsubst,example): @comment added to preserve
	the space when m4.texinfo is edited and whitespace.el is active.
	(Defn,example): idem.

1998-08-20  Erick Branderhorst  <Erick.Branderhorst@asml.nl>

	* doc/m4.texinfo (Esyscmd): grep ../Makefile instead of
	../COPYING. ../Makefile is a file which is certainly present when
	test is executed in testSubDir. One can't be sure that the COPYING
	file is in .. or ../.. in all situations, the ../Makefile is
	always there.

	* doc/m4.texinfo (Include): adjusted expected test output
	according to new tests, i.e. the input will always come from the
	file `in' created by the test.

	* tests/Makefile.am: Added three lines at the top to get
	esyscmd.1.test working.

	* tests/get-them: modified to generate clearer tests who will need
	less maintenance when new test examples are created in
	`doc/m4.texinfo'. All tests are small (nearly stand-alone, they
	need the generic file `defs') shell scripts creating `in', `ok',
	`out' and when apropriate `okerr' and `err' in the directory
	`testSubDir' when executed. The compare of `ok' and `out'
	(and of `okerr' and `err') will be the exit status of the test.
	`out' must match `ok' (and `okerr' must match `err') for the test
	to be succesful.

	* tests/[a-b]\{1,8\}.[0-9]+.test: This namespace is reserved for
	the tests generated by tests/get-them getting it input normally
	from doc/m4.texinfo. The namespace tests/[a-b]+[0-9]+.test (no `.'
	(dot) before the numeric part) is reserved for all other (hand
	written) tests. The `+' means one or more times.

1998-08-12  Erick Branderhorst  <Erick.Branderhorst@asml.nl>

	* doc/Makefile.am (EXTRA_DIST): helptoman.pl and $(MANS) to
	supported short man page to refer to info documentation
	* helptoman.pl: added
	* configure.in: AC_PATH_PROG(PERL,perl)
	* Makefile.am (SUBDIRS): doc after src

	* libitized with libit 0.5 from
	ftp://ftp.iro.umontreal.ca/pub/contrib/pinard/maintenance/libit.

	* configure.in (AC_REPLACE_FUNCS): added xmalloc xstrdup
	* lib/Makefile.am (libm4_a_SOURCES): removed automakely supported
	  replacement functions, (libm4_a_LIBADD): @LIBOBJS@
	* configure.in (AM_WITH_REGEX), acconfig.h (WITH_REGEX): added
	  lib/rx.{c,h}: added
	* configure.in (AC_CHECK_FUNC): getopt_long

	* src/m4.c (usage): Report bugs to m4-bugs@gnu.org.

	* TODO: added entry about dependencies

1998-08-10  René Seindal  <rene@seindal.dk>

	* Prerelease 1.4f

	* doc/m4.texinfo (Changesyntax): Added documentation for the macro
	"changesyntax".

	* src/builtin.c (m4_changesyntax): Added builtin macro
	"changesyntax" to modify the syntax table.

	* src/input.c, src/m4.h, src/macro.c: Implemented an input syntax
	table.  All categories are assigned a syntax code and tokens are
	read according to this table.

1998-08-09  René Seindal  <rene@seindal.dk>

	* src/numb.{c,h}: New files, implements multiple precision eval
	using GNU gmp.  Originally submitted by John Gerard Makecki
	(johnm@vlibs.com), later modified.  Tested with GNU gmp 2.0.2.

	* doc/m4.texinfo (Eval): Added documentation for multiple
	precision arithmetic library support.

	* src/m4.{c,h}, src/eval.c, src/builtin.c, configure.in: Changes
	to accommodate multiple precision eval.

1998-08-07  René Seindal  <rene@seindal.dk>

	* src/input.c (MATCH, match_input), src/m4.h: changed definition
	of comment and quote strings to `unsigned int' to allow eight bit
	chars (reported by andrewb@zip.com.au (Andrew Bettison)).

	* src/builtin.c, doc/m4.texinfo: Builtin `syncoutput' added by
	patch from Mike Howard <mike@clove.com>

1998-08-06  René Seindal  <rene@seindal.dk>

	* gettext.m4: corrected AM_WITH_NLS to handle use of installed
	-lintl.

1998-08-03  René Seindal  <rene@seindal.dk>

	* Prerelease 1.4e

	* src/m4.h: Added ifdef ENABLE_NLS around include of <libintl.h>
	and _ macro.  M4 now builds with --disable-nls.

	* src/m4.c (main): reintroduced textdomain(PACKAGE) to get gettext
	to look for right message catalogs.  Call indef'ed by ENABLE_NLS.

	* configure.in (ALL_LINGUAS): Added complete list of translations:
	de fr it ja nl ru sv.

1998-05-22  Erick Branderhorst  <Erick.Branderhorst@asml.nl>

	* Prerelease 1.4d.

	* src/m4.c: #include <signal.h> not <sys/signal.h>.

	* src/Makefile.am: CFLAGS = -Wall @CFLAGS@.

	* checks/Makefile.am: explicit list tests in CHECKS.

	* configure.in, {,src,doc,lib,examples,checks}/Makefile.am,
	src/{ansi2knr.{1,c}} doc/{m4.texinfo,mdate-sh}, missing,
	mkinstalldirs, install-sh: Added automake (1.3) support.

	* lib/{alloca.c,error.{c,h},get{date.h,opt.{c,h},opt1.c},
	obstack.{c,h},regex.{c,h},strtol.c,xmalloc.c,xstrdup.c}:
	Used libitize (0.4) to update.

	* configure.in, ABOUT-NLS, intl/*, po/*: Added gettextize
	(0.10.25) support. Removed LOCALE, fr.msg, m4.cod and adjusted
	README accordingly.

	* src/stackovf.c: #ifdef USE_STACKOVF ... #endif to (de-)activate
	stack overflow functionality.

1994-12-03  François Pinard  <pinard@iro.umontreal.ca>

	* Prerelease 1.4.1.

	* Makefile.in (realclean-local): Delete stamp-h.in.

	* configure.in, {,src,lib}/Makefile.in, src/m4.h, src/m4.c:
	Localize, adapting from how it is done in sharutils.

	* fr.tt: New file, for French.

	* configure.in, {,*/}Makefile.in, acconfig.h, src/m4.c,
	src/freeze.c: Rename PRODUCT to PACKAGE.

1994-11-26  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: Check for <libintl.h> and <locale.h>.
	* src/m4.h, src/builtin.c, src/debug.c, src/eval.c, src/macro.c,
	src/stackovf.c: Rename _ to __P.
	* src/m4.h: Declare _ as a macro returning its argument, or else,
	include <libintl.h> and declare _ as gettext.
	* src/m4.c: Possibly include <locale.h> and call setlocale.
	* src/m4.c, src/builtin.c, src/debug.c, src/eval.c, src/freeze.c,
	src/input.c, src/macro.c, src/output.c, src/path.c,
	src/stackovf.c, src/symtab.c: Use _ macro over all localizable
	strings.

1994-11-07  François Pinard  <pinard@iro.umontreal.ca>

	* doc/Makefile.in (stamp-vti): Use new -r option to date.

	* configure.in: Put --with-gmp in place, in prevision for John
	Gerard's work.
	* acconfig.h: Document WITH_GMP.

1994-11-05  François Pinard  <pinard@iro.umontreal.ca>

	* Release 1.4.

	* doc/Makefile.in (realclean): Also remove stamp-vti.
	Reported by Eric Backus.

1994-11-02  François Pinard  <pinard@iro.umontreal.ca>

	* src/freeze.c (produce_frozen_state): If the frozen file cannot
	be opened, return immediately after producing the error message.
	Reported by Andreas Schwab.

	* configure.in: Check for const only after having found possible
	ANSIfying compiler flags, this is of no use to check it before.
	Reported by Alexander Lehmann.

1994-11-01  François Pinard  <pinard@iro.umontreal.ca>

	* src/macro.c (collect_arguments): Cast obstack arguments to
	(voidstar), so avoiding compiler warnings.
	Reported by Joseph E. Sacco.

	* src/freeze.c (produce_frozen_state): Cast printed lengths to
	(int) so they correspond to %d format items.
	Reported by Joseph E. Sacco.

	* src/m4.c (main): Cast the argument to xfree to (voidstar).
	* src/symtab.c (free_symbol): Idem.
	Reported by Karl Vogel.

1994-10-31  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (DISTFILES): Distribute BACKLOG.

	* configure.in: Define PRODUCT and VERSION.
	* acconfig.h: Document PRODUCT and VERSION.
	* src/m4.c, src/freeze.c: Use PRODUCT and VERSION instead of the
	constant string m4 and variable or parameter named version.

1994-10-30  François Pinard  <pinard@iro.umontreal.ca>

	* src/m4.h, src/debug.c: Replace all #ifdef __STDC__ by #if
	__STDC__.  Alliant FX/2800 Concentrix 2.2 (i860-BSD4.3) compiler
	defines __STDC__ to 0, for indicating it is *not* ANSI!
	Reported by Kaveh R. Ghazi.

	* configure.in: Added obsolescent tests for AIX and Minix.

	* doc/Makefile.in (mostlyclean): Remove texclean in dependencies,
	which texclean does not exist anymore.
	Reported by Eric Backus, Jim Meyering, John David Anglin and
	Joseph E. Sacco.

1994-10-29  François Pinard  <pinard@iro.umontreal.ca>

	* aclocal.m4 (fp_C_PROTOTYPES): Force -D_HPUX_SOURCE with -Aa.
	Reported by John David Anglin.

	* src/ansi2knr.c: New version, sent by Peter Deutsch.
	* aclocal.m4 (fp_C_PROTOTYPES): Substitute empty or ansi2knr for
	ANSI2KNR, depending on the fact the compiler is ANSI or not.
	* src/Makefile.in: Use -Ovarargs=convert on ansi2knr calls.
	Remove the sed filter after ansi2knr for debug.c.  Use $O instead
	of $U, put underline in extensions rather than in basenames.  Use
	implicit rules, now that regularity makes this possible.
	Have $(OBJECTS) depend on $(ANSI2KNR), so to trigger compilation
	of ansi2knr whenever it is needed.
	* configure.in: Adjusted for correct STACKOVF substitution.
	* src/debug.c (trace_format): When not __STDC__, use (...) as a
	parameter list, so ansi2knr will convert it to (va_alist) va_dcl.
	Reported by David MacKenzie.

	* Makefile.in: Remove binprefix.  Use transform_name instead.
	Reported by David MacKenzie.

	* doc/Makefile.in: Create version.texi, use it, clean it.
	Reported by Jim Meyering.

1994-10-28  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (all, install, uninstall): Depend on Makefile.

	* Makefile.in: For actions invoking $(MAKE) from within compound
	sh statements, exit non-zero if the sub-make fails.  Otherwise,
	the top-level make may exit successfully when it should fail.
	Reported by Jim Kingdon.

	* {,/*}Makefile.in: Use && after all cd, in case they fail.

	* {,*/}Makefile.in: Declare PRODUCT and VERSION macros.
	(dist): Use PRODUCT and VERSION instead of tricks on .fname.
	* configure.in: Substitute PRODUCT and VERSION.

	* {,*/}Makefile.in (dist): Always try a hard link before a copy.

1994-10-27  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (mostlyclean-local): Do not remove *~.
	* */Makefile.in (mostlyclean): Idem.
	Reported by Robert E. Brown and Richard Stallman.

1994-10-09  François Pinard  <pinard@iro.umontreal.ca>

	* src/m4.h: Get rid of CONFIG_BROKETS.

1994-10-02  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: Use AC_ARG_PROGRAM.
	* aclocal.m4 (fp_C_PROTOTYPES): Substitute @kr@ by kr or empty.
	Reported by David MacKenzie.

1994-10-01  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: Do not add -O to CFLAGS for GNU C, now that
	configure does it automatically.
	Reported by Jim Meyering.

1994-09-23  François Pinard  <pinard@iro.umontreal.ca>

	* src/stackovf.c: Declare the handler_t typedef earlier in the
	code, use it for stackovf_handler.
	(setup_stackovf_trap): Use RETSIGTYPE instead of void while
	casting sigsegv_handler.
	Reported by Robert Bernstein.

	* src/m4.c (main): Initialize program_name to argv[0] without
	basename'ing it.
	Reported by Karl Berry.

1994-09-18  François Pinard  <pinard@iro.umontreal.ca>

	* src/Makefile.in (TAGS): Include a ../lib/TAGS reference.
	Reported by Karl Berry.

1994-09-14  François Pinard  <pinard@iro.umontreal.ca>

	* lib/Makefile.in (mostlyclean): Added.
	(TAGS): Make in $(srcdir).

	* configure.in: Use `choke me' in test, like everywhere!

	* {doc,examples,lib,src}/Makefile.in (check): Deleted, as
	unreacheable and useless.

	* doc/Makefile.in (texclean): Deleted, merged in mostlyclean.

	* lib/Makefile.in (DISTFILES): Distribute TAGS.
	(distclean): Do not remove TAGS.
	(realclean): Remove it.
	* Makefile.in: Make TAGS in lib also, not just in src.
	Reported by Karl Berry.

	* Makefile.in (distclean, realclean): Instead of recursively
	calling $(MAKE) for the -local part, allow parallel execution of
	-recursive and -local, only delay the removal of config.status,
	which is repeated in both goals.

1994-09-13  François Pinard  <pinard@iro.umontreal.ca>

	* Release 1.3.

	* Makefile.in: Group all *clean-recursive goals in one, using sed
	to remove `-recursive' while calling make recursively.  Also, use
	a subshell for each recursive $(MAKE).
	Reported by Jim Meyering.

	* src/m4.h (memcpy): Define with bcopy for BSD systems.
	Reported by Kaveh R. Ghazi.

	* src/Makefile.in (ansi2knr): Use $(LIBS) while linking, for SunOS
	4.1.3 requires -ldl to link even ansik2nr, and we need a way to
	specify it.

	* configure.in: Use date instead of touch for stamp-h.
	* Makefile.in (stamp-h.in): Idem.

	* Makefile.in (distclean, realclean): Force serial execution of
	both goals, in case parallel makes are being used.
	Reported by Jim Meyering.

	* src/Makefile.in (DISTFILES): Distribute TAGS.
	(distclean): Do not remove TAGS.
	(realclean): Remove it.
	Reported by Karl Berry.

1994-09-10  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: Use fp_ to match aclocal.m4.  Revert _OS_ macros
	to old names, for following Autoconf.

1994-09-08  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (MDEFINES): Remove INSTALL substitutions, for
	./install.sh will not be correctly referred to in sub-Makefiles.
	Reported by John David Anglin.

	* doc/Makefile.in (texclean): Remove *.cps and *.fns too.
	Reported by Eric Backus.

	* Makefile.in, checks/Makefile.in, doc/Makefile.in,
	examples/Makefile.in, lib/Makefile.in, src/Makefile.in: Limit
	config.status into remaking this directory's Makefile only.
	* Makefile.in (stamp-h): Do not check nor touch stamp-h.
	* configure.in (AC_OUTPUT): Touch stamp-h if CONFIG_HEADERS.
	Reported by Jim Meyering.

1994-09-06  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: Correct stack overflow detection logic, taking
	care of systems having only incomplete implementations (like for
	Pyramid 9820 OSx 5.0d).
	Reported by Kaveh R. Ghazi.

	* src/Makefile.in (TAGS): Remote -t from etags call.

1994-09-02  François Pinard  <pinard@iro.umontreal.ca>

	* lib/Makefile.in (install): Depend on all.

1994-08-31  François Pinard  <pinard@iro.umontreal.ca>

	* examples/Makefile.in (mostlyclean): Do not depend on texclean.
	Reported by Jim Meyering and John David Anglin.

	* Makefile.in (distclean-local): Delete config.log.
	Reported by Jim Meyering.

        Solidify frozen files with respect to -P:
	* src/m4.c: Have -P set prefix_all_buitins variable instead of
	calling a function by that name.  Declare the variable.
	* src/m4.h: Adjust declaration for prefix_all_buitins.
	* src/builtin.c (builtin_init): Merge in functionality from
	previous prefix_all_buitins function, while making entries in the
	symbol table, but not modifying the builtin description itself.

	* src/freeze.c (reload_frozen_state): Add a useless `break;',
	because *many* compilers do not accept an empty `default:'.
	Reported by Akiko Matsushita, Eric Backus, John David Anglin,
	Joseph E. Sacco, Kaveh R. Ghazi, Tom McConnell and Ulrich Drepper.

	* configure.in: Use AC_TYPE_SIGNAL.
	* src/stackovf.c (setup_stackovf_trap): Use RETSIGTYPE.
	Reported by Robert Bernstein.

	* checks/Makefile.in (check): Modify PATH so check-them will find
	m4 in the src directory.
	* Makefile.in (check): Don't.
	Reported by Akiko Matsushita and Jim Meyering.

	* src/output.c (make_room_for, output_character_helper): New
	functions, for implementing a global MAXIMUM_TOTAL_SIZE instead of
	a per buffer MAXIMUM_BUFFER_SIZE.

	* src/output.c (output_text): New function, for optimizing the
	output of strings of characters.  Use it.

1994-08-30  François Pinard  <pinard@iro.umontreal.ca>

	* doc, src: New directories reorganizing the distribution.
	* doc/Makefile.in, src/Makefile.in, examples/Makefile.in: New
	files.
	* Makefile.in: Adjusted.
	* configure.in: Configure new Makefiles.

	* m4.h: Declare STRING typedef.  Use it for comment and quote
	strings, adjusting all references.  (This is the rudiments of a
	beginning for the eventual withdrawal of NUL terminated strings.)
	* output.c (shipout_text): Accept a length parameter, and use it.
	All callers adjusted.

1994-08-29  François Pinard  <pinard@iro.umontreal.ca>

	* m4.h: Include <unistd.h> if it exists.
	* stackovf.c: Don't.

	Clean up for current_diversion variable:
	* output.c: Move current_diversion from builtin.c.
	* m4.h: Declare current_diversion so builtin.c can access it.
	* output.c (output_init, make_diversion): Initialize or update
	current_diversion.
	* builtin.c (builtin_init, m4_divert): Leave current_diversion
	alone.

	Remove limit on number of diversions:
	* output.c: Replace ndiversion by diversions, declare it.
	(output_init): Allocate only diversion 0.
	(make_diversion): Allocate new diversions as needed.
	* m4.h, m4.c: Remove NDIVERSIONS and ndiversion related stuff.
	* m4.c: Still accept -N, but do nothing with it.
	Reported by David MacKenzie.

	Freeze diversions:
	* output.c (freeze_diversions): New function.
	* m4.h: Declare freeze_diversions.
	* freeze.c: Document frozen file format, revise it, call
	freeze_diversions to add diversions to frozen format, and code to
	reload them properly.
	* m4.c: Do not undivert automatically at end when status being
	frozen.  Do not call builtin_init when reloading frozen state.

	Speed up diversion processing:
	* output.c: Add INITIAL_BUFFER_SIZE, MAXIMUM_BUFFER_SIZE,
	COPY_BUFFER_SIZE, in-memory diversion buffers, struct diversion
	structure and variables, cached variables out of output_diversion,
	reallocate_diversion_for and OUTPUT_CHARACTER.
	(shipout_text, make_diversion, insert_diversion): Adapted to new
	structures.
	(insert_file): Use better buffering.
	Reported by David MacKenzie.

1994-08-28  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in, lib/Makefile.in, checks/Makefile.in: Arrange so
	dist works from another build directory.

1994-08-27  François Pinard  <pinard@iro.umontreal.ca>

	* symtab.c (hack_all_symbols): Use hash_table_size instead of
	constant HASHMAX, for -H option to work better.

	* builtin.c (DECLARE): Simplify by using _ ().

	* freeze.c: New file.
	* Makefile.in: Compile it, distribute it.
	* m4.c: Recognize, document and process --freeze-state (-F) and
	--reload-state (-R) options.  Pass a true flag to builtin_init
	only if no reloading some state.
	* builtin.c (define_builtin): Remove static specifier.
	(find_builtin_by_name): Remove static specifier.
	(builtin_init): Accept and obey a flag argument.
	* m4.h: Add declarations for freeze.c, changes for builtin.c.

1994-08-24  François Pinard  <pinard@iro.umontreal.ca>

	* builtin.c (dumpdef_cmp): Rewrite so the cast protect the const
	specifier.

	* configure.in: Implement --with-dmalloc.
	* acconfig.h: Document WITH_DMALLOC.
	* m4.h: Add code for when WITH_DMALLOC.

1994-08-15  François Pinard  <pinard@iro.umontreal.ca>

	* m4.c (long_options): Use "error-output", the dash was missing.
	Reported by Akiko Matsushita.

1994-08-12  François Pinard  <pinard@iro.umontreal.ca>

	* m4.h: Include <sys/types.h>.
	* builtin.c, debug.c, m4.c, output.c, stackovf.c: Don't.
	* m4.h: Declare len_lquote and len_rquote as size_t, not int.
	int.
	* input.c: Declare len_lquote, len_rquote, len_bcomm and len_ecomm
	as size_t, not int.
	* builtin.c (dump_args): Declare len as size_t, not int.

	* debug.c: Prototype the forward declaration of debug_set_file.

	* builtin.c (m4_undivert):  Replace div by file, for avoiding the
	shadowing of this variable.
	* output.c (insert_diversion): Idem.

	* input.c: Delete def_rquote, def_lquote, def_bcomm and	def_ecomm.
	(input_init): Duplicate default quote and comment strings.
	(set_quotes): Free previous quote strings in all cases.  Duplicate
	even default quote strings.
	(set_comment): Free previous comment strings in all cases.
	Duplicate even default comment strings.

	* configure.in: Updated for Autoconf 2.0.
	* Makefile.in (distclean-local): Also delete config.cache.

	* m4.c (usage): Reorganize the --help output by topic.  Include a
	description for debugging flags.

1994-07-29  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: If sigaction is available and SA_ONSTACK defined,
	use sigaction.  Otherwise, if sigvec is available and SV_ONSTACK
	defined, use sigvec.  Else don't compile stackovf.c.
	* stackovf.c (setup_stackovf_trap): Idem.
	Reported by Jim Avera, Karl Berry, Kaveh R. Ghazi, Matthias Rabe
	and Simon Leinen.

1994-07-21  François Pinard  <pinard@iro.umontreal.ca>

	* m4.c (usage): Replace printf par fputs.

1994-07-18  François Pinard  <pinard@iro.umontreal.ca>

	* Release 1.2

1994-07-17  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: Check for sigaction and sigvec.  Add a new delayed
	check for RLIMIT_STACK, combine in the checking for getrlimit.
	All those things are not universally available.
	* stackovf.c: Split setting up the trap handler and catching
	signals, for better taking care of various configure outcomes.
	* examples/stackovf.sh: Correct a typo.
	Reported by Eric Backus, Jim Avera and Jim Meyering.

1994-07-16  François Pinard  <pinard@iro.umontreal.ca>

	* ansi2knr.c: New version sent by its author, Peter Deutsch.

1994-07-15  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in: Modify so parallel make will not try making
	lib/libm4.a twice simultaneously.
	Reported by Jim Meyering.

1994-07-14  François Pinard  <pinard@iro.umontreal.ca>

	* stackovf.c (setup_stackovf_trap): Replace "Don't" by "Do not" in
	error message, for when no code possibility exists.  Even if this
	line is completely #ifdef'ed out, it brings a syntax error.
	Reported by Andreas Schwab, Jim Meyering and Joseph E. Sacco.

	* Makefile.in (install): Have install depend on all too, for lib
	to be remade as needed.

	* examples/stackovf.sh: Try ksh, bsh and bash for shells
	providing ulimit, instead of using only ksh.
	Reported by Jim Avera and Joseph E. Sacco.

1994-07-12  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (check): Have it depend on all instead of m4.  In
	this way, a change in lib will be detected and processed.

	* builtin.c (numeric_arg): Use strtol and verify the conversion,
	instead of using sscanf which stops as soon as there is a
	non-digit in the input.  Previously, incr(1xyzzy), eval(1,2xyzzy)
	and divert(1xyzzy) were all accepted without any warning or error
	messages.
	* m4.h: Declare strtol as long if not including stdlib.h.
	* configure.in: Check for limits.h, and replace strtol if missing.
	* lib/Makefile.in: Substitute LIBOBJS.  Distribute strtol.c.
	* lib/strtol.c: New file, from elsewhere.
	Reported by Andreas Schwab.

1994-07-07  François Pinard  <pinard@iro.umontreal.ca>

	* macro.c (expand_macro): Cast value to (boolean) prior to
	assigning it to traced.
	Reported by Tom McConnell.

	* Makefile.in (m4): Always make all in lib first.
	Reported by Jim Meyering.

1994-07-06  Jim Avera <jima@netcom.com>

	* stackovf.c: Isolated OS-dependent sections; Improved portability,
	adding support for SunOS/BSD (sigvec, sigstack, and 4-parameter signal
	handlers), and a default error message if the fault address is not
	available (when neither siginfo.h nor BSD sigcontext are supported).
	* configure.in: Changes for stackovf.h: Check for sigcontext,
	sigaction, sigstack, and define rlim_t as int if necessary.
	* acconfig.h: Added HAVE_SIGCONTEXT and rlim_t.
	* examples/stackovf.sh: Run m4 -L99999999 to allow stack overflow.
	* ansi2knr.c: Fix for func-ptr args; convert "..." to varargs syntax.

1994-07-05  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: Use AC_SET_MAKE.
	* Makefile.in: Use @SET_MAKE@.
	Reported by Jim Meyering.

	* checks/check-them: Do not trap on SIGQUIT or SIGALRM.
	Reported by Ian Taylor.

1994-07-02  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: Remove dependency of USE_STACKOVF on STDC_HEADERS,
	because siginfo.h is unrelated to standard headers, and siginfo.h
	is already checked for.
	Reported by Joseph E. Sacco.

	* acconfig.h, aclocal.m4, m4.h: Replace HAVE_PROTOTYPES by
	PROTOTYPES.
	* aclocal.m4, configure.in: Replace AC_HAVE_PROTOTYPES by
	AC_PROTOTYPES.

1994-06-29  François Pinard  <pinard@iro.umontreal.ca>

	* builtin.c (substitute): Use \& to represent this part of the
	string which was matched by the whole regexp, instead of
	representing the whole string.  Any usage of \0 issues a warning
	and acts like \&, it will disappear in some subsequent release.

1994-06-27  François Pinard  <pinard@iro.umontreal.ca>

	* m4.c: Complete prototype for forwarded declaration of usage.

	* input.c (init_macro_token): Correct own reference in error
	message.  Previous name get_macro_func was referred to instead.
	(next_char):  Correct own reference in error message.  Previous
	name advance_input was referred to instead.

	* m4.h: Declare eval_t and unsigned_eval_t typedefs to 32 bits.
	* eval.c (logical_or_term, logical_and_term, or_term, xor_term,
	and_term, not_term, logical_not_term, cmp_term, shift_term,
	add_term, mult_term, exp_term, unary_term, simple_term): Add
	prototype to forwarded declarations.  Declare parameter v1 as
	eval_t * instead of int *.  Same for local variable v2 in dyadic
	functions.  Same for result in exp_term.
	* builtin.c (m4_eval): Declare value as eval_t instead of int.
	(ntoa): Declare value as eval_t instead of int.  Declare uvalue as
	unsigned_eval_t instead of unsigned int.  Change casts accordingly.
	(shipout_int): Cast first argument of ntoa to eval_t.
	Reported by Thorsten Ohl.

	* macro.c: Complete the prototypes of forwarded expand_macro and
	expand_token.
	Reported by Thorsten Ohl.

	* m4.h: Define voidstar as void * or char * depending on __STDC__.
	The Ultrix 3.1 compiler cannot do much with void pointers.

	* builtin.c (dumpdef_cmp): Replace void * by voidstar.
	* m4.c (xfree):  Replace void * by voidstar.
	Reported by Tom McConnell.

	* ansi2knr.1: New, from elsewhere.
	* Makefile.in (DISTFILES): Distribute ansi2knr.1

	* Makefile.in (stamp-h.in): Avoid running ./config.status if
	stamp-h does not exist yet.  This avoids running it a second time
	just after the initial ./configure.
	Reported by David MacKenzie and Tom McConnell.

	* m4.h: Replace the enum debug_info declaration with a series of
	#define's.  The Ultrix 3.1 compiler would otherwise need casting
	(int) to most references, when used in expressions.
	Reported by Tom McConnell.

1994-06-25  François Pinard  <pinard@iro.umontreal.ca>

	* aclocal.m4: Replace FP_PROTOTYPES by AC_HAVE_PROTOTYPES,
	following an idea from Brook G. Milligan.  AC_HAVE_PROTOTYPES
	calls the compiler.  Previously, FP_PROTOTYPES was only calling
	the preprocessor; by not being subject to CFLAGS, this was
	discouraging those flags asking for ANSI compilation.
	* acconfig.h: Document HAVE_PROTOTYPES.
	* configure.in: Use AC_HAVE_PROTOTYPES instead of FP_PROTOTYPES.
	* m4.h: Define _() according to HAVE_PROTOTYPES, not __STDC__.
	Reported by Eric Backus.

	* configure.in: Substitute CFLAGS and LDFLAGS, taking their value
	from the environment.  Default CFLAGS to -g if not set.
	* Makefile.in: Have CFLAGS and LDFLAGS substituted from configure.
	* lib/Makefile.in: Have CFLAGS substituted from configure.
	Reported by Eric Backus and Tom McConnell.

	* configure.in: m4_undefine changeword before using AC_ENABLE.

	* m4.h: Declare prototypes for error (for ANSI compilers only),
	prefix_all_builtins and reference_error.
	Reported by Tom McConnell.

	* input.c (set_word_regexp): Do not try to initialize the array
	test from a string, this does not work with non-ANSI compilers.
	Reported by Eric Backus.

	* Makefile.in (dist): Clean examples/ before saving it.
	(distclean-local): Also remove stamp-h.
	Reported by Eric Backus.

	* Makefile.in (_stackovf.c): Goal for compiling stacokovf.c with
	non ANSI compilers.
	Reported by Tom McConnell.

	* checks/Makefile.in (clean): Depends on mostlyclean.
	(mostlyclean): New goal.

1994-06-24  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (DISTFILES): Distribute install.sh.
	* install.sh: New file, copied from elsewhere.
	Reported by Assar Westerlund and Kaveh R. Ghazi.

1994-06-23  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: Define ENABLE_CHANGEWORD if --enable-changeword.
	* acconfig.h: Explain ENABLE_CHANGEWORD.

	[These modifs all depend upon ENABLE_CHANGEWORD and are adapted
	from code provided by Pete Chown]
	* m4.h: Add original_text field to u_t variant of union u.
	Declare TOKEN_DATA_FUNC macro.
	* builtin.c: Declare changeword.
	(m4_changeword): New function.
	* input.c: Include "regex.h", define variables with word regexps.
	(input_init): Initialize the word regexp.
	(set_word_regexp): New.
	(next_token): Declare local variables, use the previous code if
	default_word_regexp is true.  Else, match using a new code.  Save
	the original text.
	* macro.c (expand_token): Ship out original text if not a macro
	name.
	Reported by Krste Asanovic and Pete Chown.

	[These modifs all depend upon ENABLE_CHANGEWORD]
	* m4.h: Declare external user_word_regexp.
	* m4.c: Declare user_word_regexp, and initialize it from
	--word-regexp or -W, or NULL if not specified.
	* input.c: Use user_word_regexp if specified, instead of
	DEFAULT_WORD_REGEXP.

	* Makefile.in (m4): Revert Jan 3 1994 change.  I'm unable to
	agree with it.

	* Makefile.in, lib/Makefile.in: Limit suffixes to .c and .o.
	* checks/Makefile.in: Empty the suffix list.
	Reported by Geoff Russell, Joel Sherrill and Roland McGrath.

	* m4.c: Declare nesting_limit and initialize it to 250.
	Implement -LNUMBER or --nesting-limit=NUMBER to change its
	value.
	* m4.h: Declare nesting_limit as external.
	* macro.c (expand_macro): Stop execution whenever nesting limit
	is exceeded.
	Reported by Bengt Mertensson.

	* eval.c (evaluate): Diagnose excess characters in eval input.
	Things like `eval(08)' used to return 0 with no diagnostic.

	* m4.h: Capitalize first letter of all macro arguments in
	definitions.

	* m4.c: Declare warning_status, initialize it to 0.  Add new
	option -E, or --fatal-warnings, which sets warning_status to
	EXIT_FAILURE instead.
	* m4.h: Declare external warning_status.  Define EXIT_SUCCESS and
	EXIT_FAILURE if not otherwise done by header files.
	* m4.c: Delete declarations for EXIT_SUCCESS and EXIT_FAILURE.
	* m4.c, input.c, output.c, symtab.c, builtin.c, macro.c, debug.c,
	eval.c: Replace 0 by warning_status and 1 by EXIT_FAILURE in first
	argument of all M4ERROR calls.
	Reported by Noah Friedman.

	* examples/incl-test.m4: Renamed from incl_test.m4.
	* examples/include.m4: Include incl-test.m4 instead of
	incl_test.m4.
	* examples/multiquotes.m4: Renamed from multi-quotes.m.

1994-06-22  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: Avoid USE_STACKOVF if <siginfo.h> not found.  Note
	that Jim developped stackovf.c on a 486 running SVR4.0 (ESIX), and
	also tested it on a Sun Sparc workstation running SunOS 4.x.

	* format.c (format): When not HAVE_EFGCVT, m4 was failing the
	49.format check, abusing a `union values' argument with sprintf
	without selecting the proper field.  Now, save the formatting type
	first, delaying the fetch of the corresponding argument.
	Reported by Joseph E. Sacco and Tom Quinn.

	* format.c (format): Remove const from char *fmt declaration when
	not HAVE_EFGCVT, because a NUL may be forced into it.

	* m4.h: Declare atof() when not STDC_HEADERS.
	Reported by Joseph E. Sacco.

	* Regenerate configure using Autoconf 1.11, this corrects a
	problem about an incorrect cpp seting on NeXT 3.1.
	Reported by Alexander Lehmann.

1994-06-05  François Pinard  <pinard@iro.umontreal.ca>

	* m4.h (_): Change argument from `x' to `Args'.

1994-04-22  François Pinard  <pinard@iro.umontreal.ca>

	* m4.h: Rename Args() to _().
	* m4.h: Remove extern specifier from all function declarations.

1994-04-22  Jim Avera <jima@netcom.com>

	* stackovf.c: New file implementing stack-overflow detection.
	* configure.in: Check for getrlimit, sigaction.  If all of
	standard headers, getrlimit and sigaction, define USE_STACKOVF and
	substitute ${U}stackovf.o for STACKOVF.
	* acconfig.h: Declare USE_STACKOVF.
	* Makefile.in: Distribute stackovf.c, link with $(STACKOVF).
	* m4.h: Declare setup_stackovf_trap().
	* m4.c: Call setup_stackovf_trap().
	* tests/stackovf_test.sh: New file.

1994-04-13  François Pinard  <pinard@iro.umontreal.ca>

	* checks/Makefile.in: Rename .all-stamp to stamp-checks.

	* Makefile.in (Makefile, etc.): Adapt for Autoconf 1.8.

1994-01-30    <pinard@iro.umontreal.ca>

	* m4.h: Remove definition of volatile, not used anymore.
	Reported by Jim Meyering and Joseph E. Sacco.

	* m4.h: Consistently use `do { ... } while (0)' in macros, instead
	of `if ... else /* nothing */' for if macros.
	Reported by Jim Meyering.

	* builtin.c (m4_regexp): Reorganize the code for avoiding a
	warning from gcc about `repl' possibly used before defined.
	Reported by Jim Meyering.

	* m4.h: Avoid a pre-ANSI <memory.h> together with <string.h>.
	Reported by Jim Meyering.

1994-01-25  François Pinard  <pinard@iro.umontreal.ca>

	* m4.h: Move the conditional definition of volatile after the
	inclusion of system files, because they may define it first.

1994-01-04  François Pinard  <pinard@iro.umontreal.ca>

	* checks/Makefile.in (CHECKS): Add a useless `*' before `[', to
	get around a problem with Alpha make seeing a syntax error, there.
	Reported by Vern Paxson.

1994-01-03  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in: Do not define LDFLAGS, use CFLAGS on link calls.
	Reported by Richard Stallman.

1993-12-25  François Pinard  <pinard@iro.umontreal.ca>

	* configure.in: Correct test for strerror, AC_FUNC_CHECK was used
	instead of AC_HAVE_FUNCS.
	Reported by Noah Friedman.

1993-12-01  François Pinard  <pinard@iro.umontreal.ca>

	* m4.c: Initialize show_help and show_version to zero.

	* m4.c: Ensure EXIT_SUCCESS and EXIT_FAILURE are defined.
	Use them in exit() and usage() calls.

1993-11-27  François Pinard  <pinard@iro.umontreal.ca>

	* m4.h: Delete extern sys_nerr, sys_errlist declarations, and
	syserr() macro.  Delete errref, add reference_error and M4ERROR.
	* m4.c: Replace errref, which was returning an input reference
	string, with reference_error, which prints it on standard error.
	* builtin.c, output.c: Use errno as second parameter to error,
	instead of using syserr() with %s.
	* *.c: Use M4ERROR instead of error: no more errref() with %s.
	Doing so, the program name appears after the input reference
	instead of before, which eases M-x next-error processing.

1993-11-24  François Pinard  <pinard@iro.umontreal.ca>

	* checks/get-them: Escape braces with backslashes in patterns,
	because HPUX-9.01 awk needs this.
	Reported by Jim Meyering.

1993-11-22  François Pinard  <pinard@iro.umontreal.ca>

	* builtin.c: Declare "FILE *popen ();".

	* m4.h: Remove MESSAGE{,1,2}, WARNING1, FATAL{,1}, INTERNAL_ERROR
	macros, replace error_message_prefix() declaration by errref()'s.
	Declare xrealloc, for use in errref().
	* m4.c: Delete error_message_prefix() function, add errref().
	* *.c: Use error() systematically in place of all error macros,
	now that error() flushes stdout first.  Make needed adjustments.

	* m4.h: Remove const in sys_errlist[] declaration, it creates
	conflicts on SGI and Alpha.
	Reported by Kaveh R. Ghazi.

1993-11-20  François Pinard  <pinard@iro.umontreal.ca>

	* m4.c: Include <getopt.h> instead of "getopt.h".

	* configure.in: Output to config.h.  Use HAVE_FUNCS preferably.
	* acconfig.h: New, for documenting HAVE_EFGCVT.
	* Makefile.in: Distribute acconfig.h, .stamp-h.in and config.h.in,
	use them wherever appropriate.  Also use -I. for compilations.
	* lib/Makefile.in: Use -I.. for compilations.
	* *.c: Include <config.h> or "config.h".

	* m4.h: Test for HAVE_MEMORY_H instead of NEED_MEMORY_H.
	* configure.in: Use AC_HAVE_HEADERS(memory.h), delete AC_MEMORY_H.

1993-11-17  François Pinard  <pinard@iro.umontreal.ca>

	* builtin.c (m4_eval): Cast strlen to (int) before comparing.

	* input.c (input_init): Initialize quote and comment strings
	explicitely instead of calling set_quotes and set_comment: by
	doing so, we ensure we do not free uninitialized variables.

	* checks/check-them: Reverse arguments to both diff, so the
	expected is on the left and the obtained on the right.

	* m4.h: Add MESSAGE{,1,2}, WARNING1, FATAL{,1} and INTERNAL_ERROR
	macros. Delete declarations for m4error, warning, fatal and
	internal_error, add declaration for error_message_prefix.
	* m4.c:  Delete m4error, warning, fatal and internal_error
	routines, add error_message_prefix routine.
	* *.c: Replace m4error routine calls with MESSAGE* macro calls,
	warning with WARNING*, fatal with FATAL* and internal_error with
	INTERNAL_ERROR*.
	* Makefile.in (_m4.c): Do not adjust ansi2knr output for va_alist,
	this is not needed anymore.

	* m4.h: Declare extern FILE *debug.  Add DEBUG_PRINT{1,3} and
	DEBUG_MESSAGE{,1,2} macros.  Delete declarations for debug_print
	and debug_message, add declaration for debug_message_prefix.
	* debug.c: Remove static specifier for FILE *debug declaration.
	Delete debug_print and debug_message routines, add
	debug_message_prefix routine.
	* builtin.c, debug.c: Replace debug_print routine calls with
	DEBUG_PRINT* macro calls.
	* input.c, path.c: Replace debug_message routine calls with
	DEBUG_MESSAGE* macro calls.

	* m4.h: Remove inclusion of <varargs.h>.
	* debug.c: Include <stdarg.h> or <varargs.h>.
	(trace_format): Use stdarg instead of varargs if __STDC__.

	* configure.in: Remove checks for vfprintf and _doprnt.  These
	implementations use varargs tricks which are not portable enough.
	* lib/vfprintf.c: Deleted.
	* lib/_doprnt.c: Deleted.
	* lib/Makefile.in: Adjusted accordingly.  Remove LIBOBJS.
	Reported by Joel Sherrill.

	* path.c (add_include_directory): Use xstrdup.

	* builtin.c (find_builtin_by_name): Declare static.

	* *.[ch]: Add const to a few "char *" declarations.

	* configure.in: Remove commented tests for fileno() and fstat().
	* debug.c: Remove comments about HAVE_FILENO and HAVE_FSTAT.

	* debug.c (debug_flush_files): New.
	* m4.h: Declares it.
	* builtin.c (m4_syscmd, m4_esyscmd): Use it.
	Reported by Nicolas Pioch.

1993-11-12  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (m4.dvi): Use m4.texinfo instead of m4.texi.
	Reported by Joel Sherrill.

	* builtin.c (prefix_all_builtins): Instead of the table size, use
	the null entry at end for stopping the loop.  It was overwritten.
	Reported by Andreas Schwab and Jim Meyering.

	* builtin.c (prefix_all_builtins): Cast xmalloc to (char *).
	Reported by Kaveh R. Ghazi.

	* macro.c (call_macro): Add * in (*SYMBOL_FUNC (sym)) (...).
	Reported by Karl Vogel.

1993-11-09  François Pinard  <pinard@iro.umontreal.ca>

	* m4.h: Do not define volatile if already defined.
	Reported by René Seindal.

	* lib/Makefile.in: Add a forgotten ALLOCA=@ALLOCA@.  Grrr!

	Reported by Bernhard Daeubler, Eric Backus, Hal Peterson, Hoang
	Uong, Ian Taylor, Kaveh R. Ghazi, Tom McConnell and Walter Wong.

1993-11-08  François Pinard  <pinard@iro.umontreal.ca>

	* m4.h: Define strchr and strrchr in terms of index and rindex,
	instead of the other way around.
	* builtin.c, m4.c, path.c: Use strchr instead of index.

	* input.c (next_char): Remove a "break;" after a "return ...;".
	Reported by Tom McConnell.

1993-11-08  François Pinard  <pinard@iro.umontreal.ca>

	* Release 1.1

	* configure.in: Do not copy check files in the build hierarchy.
	* checks/check-them: Identify the m4 version being checked.  For
	finding m4, look in $PATH instead of in the parent directory.
	* Makefile.in (check): Prepend `pwd` to $PATH before checking.
	* checks/Makefile.in (.all-stamp): Always create check files in
	the source hierarchy, not anymore in the build hierarchy.
	(check): cd to the source hierarchy before performing checks.
	Do not copy nor clean COPYING anymore, take it from `..'.
	Reported by Tom McConnell.

	* Makefile.in (Makefile): Use $(SHELL).
	(config.status): Use $(SHELL).  Use "config.status --recheck"
	instead of "configure --no-create", which is obsolete.
	Reported by Tom McConnell.

1993-11-05  François Pinard  <pinard@iro.umontreal.ca>

	* m4.c (usage): Use "%s" instead of "m4" in format string.
	Reported by Jim Meyering.

	* Makefile.in: Distribute mkinstalldirs.
	Reported by Pierre Gaumond.
	Reported by Jim Meyering.
	Reported by Tom McConnell.
	Reported by Andreas Gustafsson.

	* checks/check-them: Renamed from checks/check_them.
	* checks/get-them: Renamed from checks/get_them.
	* checks/.all-stamp: Renamed from checks/.all_stamp.
	* checks/Makefile.in: Changed accordingly.
	Reported by Jim Meyering.

1993-11-04  François Pinard  <pinard@iro.umontreal.ca>

	* lib/Makefile.in (dist): Correct permissions on files.

	* output.c: Declare tmpfile, some systems don't.

1993-11-03  François Pinard  <pinard@iro.umontreal.ca>

	* checks/Makefile.in (dist): Correct permissions on files.

	* Makefile.in (dist): Ensure recursive linking for subdirectory
	`examples', also set read/write permissions on all its files.

	* mkinstalldirs: New, from elsewhere.
	* Makefile.in: Use it.

	* debug.c: Synchronize debug messages and regular output when
	the debug file and stdout are redirected to the same file.
	* configure.in: Add (commented) checks for fileno and fstat.
	Reported by Jim Avera.

	* builtin.c (m4_ifelse): Diagnose excess arguments if 5, 8, 11,
	etc., arguments, then ignore the superfluous one.  m4 used to
	diagnose missing arguments and return the empty string.
	Reported by Nick S. Kanakakorn.

1993-11-02  François Pinard  <pinard@iro.umontreal.ca>

	* m4.c (main): At end of all input, ensure all undiverted text
	goes to the main output stream.
	Reported by Andreas Gustafsson.

	* m4.c (main): exit (0), instead of return 0.

	* m4.c: Implement -P and --prefix-builtins.
	* builtin.c: Delete const specifier on builtin_tab.
	(prefix_all_builtins): New.
	Reported by Noah Friedman.
	Reported by Scott Bartram.

	* c-boxes.el: New, from elsewhere.
	* Makefile.in: Distribute it.

	* m4.h: Do not define bcopy if <string.h> defines it.
	Reported by Stephen Perkins.

	* builtin.c (define_macro): Allow a missing second argument, in
	which case it is implied empty.  Affects define and pushdef.
	Reported by Eric Allman.

1993-11-01  François Pinard  <pinard@iro.umontreal.ca>

	* m4.h: Add blind_if_no_args in struct builtin, blind_no_args in
	struct symbol adn SYMBOL_BLIND_NO_ARGS macro.
	* builtin.c: Initialize all the blindness fields in builtin_tab.
	(define_builtin): Copy the blindness of a builtin into its symbol.
	* macro.c (expand_token): Avoid processing a blind builtin if the
	next character is not an opening parenthesis.
	Reported by David MacKenzie.
	Reported by Noah Friedman.

	* configure.in: Ensure an exit status of 0 on completion.
	Reported by Vivek P. Singhal.

	* eval.c (eval_lex): Admit both lower and upper case letters for
	bases greater than 10.  Only lower case letters were accepted.

	* eval.c (eval_lex): Recognize 0bDIGITS and 0rRADIX:DIGITS syntax.
	Reported by Krste Asanovic.

	* eval.c:  Rename NOT to LNOT.  Add XOR, NOT, LSHIFT and RSHIFT.
	* eval.c (logical_not_term): New name for not_term.
	* eval.c (xor_term): New, between or_term and and_term.
	* eval.c (not_term): New, between and_term and logical_not_term.
	* eval.c (shift_term): New, between cmp_term and add_term.
	Reported by Krste Asanovic: ~, ^, <<, >>.
	Reported by Ben A. Mesander: ** vs ^.

	* m4.c: Delete xmalloc.c, xrealloc.c, xstrdup.c.
	* m4.h: Delete xrealloc.c.
	* lib/xmalloc.c: New, from elsewhere.
	* lib/xstrdup.c: New, from elsewhere.
	* lib/Makefile.in: Distribute and compile them.

	* m4.c: Change progname to program_name.
	* builtin.c, eval.c, m4.c, m4.h: Rename error to m4error.
	* lib/error.c: New, from elsewhere.
	* lib/Makefile.in: Distribute and compile error.c.
	* configure.in: Check AC_VPRINTF and for strerror.
	* m4.c: Delete cmd_error.  Use error instead.
	* m4.c: Change label capitalisation to "ERROR", "Warning", etc.

	* m4.h: Delete #define const, let Autoconf takes care of this.

	* m4.c: Remove all code conditionalized by IMPLEMENT_M4OPTS.
	Merge parse_args into main.  Declare argv to be `char *const *',
	then remove superfluous casts.

	* m4.c: Rename --no-gnu-extensions to --traditional.
	Reported by Ben A. Mesander.

	* m4.c (usage): Add a status parameter.  Supply one in various
	calls.  Add --help processing.  Remove -V for --version.

	* lib/Makefile.in: Put $(CFLAGS) last in .c.o rule.

	* lib/Makefile.in: Have an AR=ar declaration.
	Reported by Eric Backus.
	Reported by Bjorn R. Bjornsson.
	Reported by Tom Tromey.
	Reported by Kristine Lund.
	Reported by Marion Hakanson.

1993-10-30  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (m4.info): Use -I$(srcdir) on $(MAKEINFO).
	Reported by Noah Friedman.

1993-10-25  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in: Remove MDEFINES and cleanup.

1993-06-09  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (dist): Replace "echo `pwd`" by a mere "pwd".
	Create a gzip file.

1993-02-06  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in, lib/Makefile.in, check/Makefile.in: In dist goals,
	ensure 777 mode for directories, so older tar's will restore file
	modes properly.

1993-01-17  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in, lib/Makefile.in: Put $(CFLAGS) after $(CPPFLAGS),
	so the installer can override automatically configured choices.
	Reported by Karl Berry.

1993-01-15  François Pinard  <pinard@iro.umontreal.ca>

	* lib/vfprintf.c: Stolen from Oleo distribution and adapted.  The
	previous version was not working properly on m68k-hp-bsd4.3.
	Reported by Roland McGrath.

	* lib/_doprnt.c: Stolen from Oleo distribution.
	* configure.in: Check for _doprnt.c if vfprintf.c selected.
	* lib/Makefile.in: Distribute _doprnt.c.
	Do not distribute regex.[ch].old anymore.

1993-01-01  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in, lib/Makefile.in: Reinstate $(CPPFLAGS), use it.
	Richard wants it there.

1992-12-27  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in: Add DEFS to MDEFINES.
	* lib/Makefile.in (.c.o): Remove $(CPPFLAGS).
	(libm4.a): Remove the library before creating it.
	(distclean): Remove tags and TAGS too.

1992-12-23  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (dvi, m4.dvi): New goals.

	* builtin.c, eval.c, format.c, input.c, m4.[ch], m4.texinfo,
	macro.c, output.c, path.c, symtab.c: Change Copyright from
	1989-1992 to the explicit enumeration 1989, 1990, 1991, 1992.

	* examples/divert.m4: Deleted, this bug has been corrected.

	* Makefile.in (texclean, mostlyclean): New goals.

	* Makefile.in (clean): Remove clutter from ansi2knr.
	Reported by Pierre Gaumond.

1992-12-20  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in: Remove $(CPPFLAGS) from the .c.o rule.  The user
	might well use CFLAGS is s/he needs it.

	* Makefile.in: Allow installation of info files from a separate
	build directory.
	Reported by Jason Merrill.
	Reported by David MacKenzie.
	Reported by Skip Montanaro.
	Reported by Erez Zadok.
	Reported by Assar Westerlund.

1992-12-19  François Pinard  <pinard@iro.umontreal.ca>

	* Release 1.0.3
	This is still a	beta release for the future GNU m4 version 1.1.

	* lib/alloca.c: New, from elsewhere.
	* lib/Makefile.in: Distribute it.  Define and use $(ALLOCA).

	* m4.h: Do not define index/rindex if already defined.  If
	FALSE/TRUE are already defined, do not redefine them, but merely
	define boolean typedef to int.

	* Makefile.in: Use $(DEFS) while compiling ansi2knr.
	* ansi2knr.c: Rewrite #ifdef HAVE_STRING_H || STDC_HEADERS,
	because some C compilers do not like connectives with #ifdef.
	* m4.h: Define `volatile' only if __GNUC__, instead of once for
	__GNUC__ and once for __STDC__.
	* lib/regex.h: Leave const alone, AC_CONST will take care of it.

	* checks/Makefile.in: Use .all_stamp instead of $(CHECKS) for
	Makefile dependencies.  Without it, make keeps destroying and
	remaking $(CHECKS) in a loop (why?).  Distribute .all_stamp.

	* m4.h, m4.c, builtin.c, output.c: Change all divertion/DIVERTION
	to diversion/DIVERSION, this was a spelling error.

	* m4.c: Declare version[], remove #include "version.h".
	* version.h: Deleted.
	* Makefile.in: Remove references to version.h.

	* output.c (shipout_text): Centralize all `#line NUM ["FILE"]'
	production, by using a simpler and more robust algorithm.  This
	solves the problem of synclines sometimes written in the middle of
	an output line.  Delete sync_line() and output_lines variable.
	* m4.h: Remove sync_line prototype and output_lines declaration.
	* input.c (next_char), output.c (shipout_text): Remove references
	to output_lines.
	* input.c (push_file, pop_file): Merely put the value -1 in
	output_current_line instead of calling sync_line, for delaying a
	single `#line NUM FILE' before next output line.  Do not test
	for sync_output, because this is unnecessary clutter.
	* output.c (make_divertion, insert_divertion): Idem.
	* input.c: Rename must_advance_line to start_of_input_line, for
	consistency.

	* debug.c (trace_header): Select a new debug line format, which
	better complies with GNU standards for formatting error messages.
	With option `-dfl', M-x next-error might be used on the output.
	* m4.c (vmesg): Adjust format of error output to GNU standards.
	* m4.texinfo: Adjust examples for `make check' to work.

	* m4.h, builtin.c, debug.c, input.c, macro.c, path.c: Use upper
	case for enum debug_info constants, which were all lower case.

	* builtin.c (m4_regexp, m4_patsubst): Use re_search instead of
	re_search_2.
	* lib/regex.[ch]: Use new version from textutils 1.3.6, with some
	collected patches.  I tried a few times using newer regex.[ch], it
	mysteriously stopped aborting with this one.  Insecure feeling...
	* lib/Makefile.in: Distribute regex.[ch].old, just in case!

1992-12-18  François Pinard  <pinard@iro.umontreal.ca>

	* m4.c: Change `--no-warnings' to `--silent'.
	Reported by David MacKenzie.

	* m4.c: Put all M4OPTS code upon IMPLEMENT_M4OPTS control, and
	leave it off for now.  See comment in m4.c for justification.
	Reported by David MacKenzie.

	* configure.in: Replace AC_USG by AC_HAVE_HEADERS(string.h).
	* m4.h, ansi2knr.c, lib/regex.h: Replace USG by HAVE_STRING_H.

	* Makefile.in: Add a new `info' goal.  Use macro MAKEINFO.

	* Makefile.in: Ensure recursive cleaning is done before local
	cleaning for all clean goals.

	* builtin.c (ntoa): Ensure the value is always interpreted as a
	signed quantity, whatever the radix is.

1992-11-18  Jim Meyering  <meyering@idefix>

	* builtin.c, format.c, input.c: Split long lines.
	* m4.c: Use typedef macro_definition instead of struct
	macro_definition.
	* symtab.c: Use typedef symbol instead of struct symbol.

1992-11-17  François Pinard  <pinard@iro.umontreal.ca>

	* *.[ch]: Remove all trailing whitespace, in code and comments.

	* configure.in: Find some awk.
	* Makefile.in: Add $(AWK) to MDEFINES.
	* checks/Makefile.in: Transmit $(AWK) to get_them.
	* checks/get_them: Use $AWK instead of gawk.  Add a close in the
	awk script when switching files, because without this, mawk runs
	out of file descriptors.

1992-11-16  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (realclean): Delete m4.info*.
	Reported by Jim Meyering.

	* Makefile.in: Adjust and link with checks/Makefile.
	* checks/Makefile.in: New.
	* configure.in: Output checks/Makefile.

	* checks/get_them: Have the dnl header of each test more
	recognizable by next-error, also use a better message.

1992-11-16  Jim Meyering  <meyering@idefix>

        * m4.h [__GNUC__]: Use __volatile__ instead of `volatile.'
        And use that only if __GNUC__ since we're using it's GCC-specific
        semantics that tell the compiler the associated function doesn't
        return.

        * builtin.c (substitute): Don't use character as an array index.
        (dumpdef_cmp): Make formal arguments `const void *' to avoid
        warnings with gcc -W -Wall on systems with qsort prototype.
        (m4_errprint): Cast obstack_finish to `char *' to avoid warnings
        from gcc -W -Wall.

        * eval.c (most functions): Add parentheses to assignments used
        as truth values go avoid warnings from gcc -Wall.

	* input.c, m4.c, output.c, path.c, symtab.c: Declare static
	any functions that don't need external scope.

	* builtin.c, debug.c, format.c, m4.c, m4.h, macro.c, symtab.c
	(many functions and arrays): Declare `const'.

1992-11-15  François Pinard  <pinard@iro.umontreal.ca>

	* *.[ch]: Rename nil to NULL, using the declaration from <stdio.h>,
	removing the declaration from m4.h.  Also rename false to FALSE
	and true to TRUE.

	* lib/Makefile.in (Makefile): New goal.

	* Makefile.in, lib/Makefile.in: Add a .c.o rule, so CFLAGS is not
	so heavily loaded.  It gets more easily overridable, calling make.
	Reported by Jim Meyering.

	* Makefile.in (dist): Get .fname from the current directory name,
	instead of from version.h.  I need updating many files manually,
	when the version changes, version.h is just one of them.

1992-11-14  François Pinard  <pinard@iro.umontreal.ca>

	* m4.h: Remove the tag `boolean' on the enum introducing typedef
	`boolean'.  This tag conflicts with <sys/types.h> on SVR4.
	Reported by Tom McConnell.

1992-11-13  François Pinard  <pinard@iro.umontreal.ca>

	* m4.texinfo: Correct the examples for 33.divert, 38.divnum,
	39.cleardiv, which were describing missing or spurious newlines.
	Modify examples 52.eval, 53.esyscmd and 54.sysval so the results
	do not depend on machine word size, `/bin/false' implementation,
	or `wc' output format.  `make check' is more dependable, now.

	* checks/check_them: Summarize the failed tests by listing their
	name, at end.  If none, issue `All checks successful'.  Output
	`Checking' instead of `Input file:'.

	* checks/get_them, checks/check_them: Reindented.

	* Makefile.in (dist): chmod a+r before making the tar file.

1992-11-12  François Pinard  <pinard@iro.umontreal.ca>

	* builtin.c (m4_dnl): Diagnose any parameter to `dnl'.

	* input.c (next_token): Reinitialize token_buttom just after using
	it as a watermark with obstack_free.  Or else, a future token, big
	enough for triggering reallocation of the obstack chunk, could
	void the initialized value of token_buttom, later causing panic in
	obstack_free.  Rename token_buttom to token_bottom everywhere.

	* m4.h: Before declaring errno, first include <errno.h> and
	ensure that it does not define errno.
	Reported by Richard Stallman.

1992-11-11  François Pinard  <pinard@iro.umontreal.ca>

	* builtin.c: Define and use DECLARE macro for builtins.

	* builtin.c (m4_ifelse): Avoid any diagnostic when exactly one
	argument, this is a common idiom for introducing long comments.

	* builtin.c (m4_ifelse): If 3n + 2 arguments, diagnose missing
	arguments.  The last argument was silently ignored.

	* m4.c (cmd_error): Add a missing semicolon before va_end().

1992-11-10  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in: Now handle protoized sources.  Define and use U.
	Compile and use ansi2knr with old compilers.  Update DISTFILES.
	Add `aclocal.m4' to `configure' dependencies.
	* ansi2knr.c: New, from Ghostscript distribution.
	* configure.in: Define U through FP_PROTOTYPES for old compilers.
	Add AC_ISC_POSIX, AC_CONST, AC_SIZE_T.
	* aclocal.m4: New, provide FP_PROTOTYPES.
	* m4.h: Conditionnaly protoized through Args, save for varags.
	* builtin.c: Protoized.  Then:
	Include <sys/types.h> if size_t is not defined, before "regex.h".
	(m4_ifelse): Fetch built-in name properly for diagnostic.
	(m4_dumpdef): Remove wrong (char *) cast calling dump_symbol.
	(m4_regexp): Add const to `msg' declaration.
	(m4_patsubst): Add const to `msg' declaration.
	* debug.c: Protoized, save for varargs.
	* eval.c: Protoized.
	* format.c: Protoized.
	* input.c: Protoized.
	* m4.c: Protoized, save for varargs.  Then:
	(xfree): Accept void * instead of char *.
	(xmalloc): Return void * instead of char *.
	(xrealloc): Accept and return void * instead of char *.
	* macro.c: Protoized.
	* output.c: Protoized.
	* path.c: Protoized.  Then cast some (char *) over xmalloc's.
	* symtab.c: Protoized.

1992-11-06  François Pinard  <pinard@iro.umontreal.ca>

	* m4.texinfo: Remove directory from diagnostics in 30.include,
	51.eval, 56.errprint and 57.m4exit tests.

	* m4.h: Remove declarations for int or void system functions, they
	cause more conflicting trouble than they make good.

	* configure.in: Avoid configuration header file.  Add some tests.
	* m4.h: Remove #include "config.h".
	* Makefile.in, lib/Makefile.in: Implement Autoconf interface.
	Then, rewritten for better compliance with GNU standards.

1992-11-05  François Pinard  <pinard@iro.umontreal.ca>

	* format.c (format): Avoid syntax error if not HAVE_EFGCVT,
	because of a misplaced #endif.

	* Many *.[hc] files: Correct intra-line spacing here and there,
	according to GNU indent 1.6 advice.

	* configure.in: New, using Autoconf 1.2.
	* m4.h: Reverse NO_MEMORY_H to NEED_MEMORY_H.
	* Delete old configure.in, configure, etc/configure.in,
	etc/configure, lib/configure.in, lib/configure and config/*.
	Reported by Jason Merrill.

	* symtab.c (hash): Change (char) NULL to '\0'.
	Reported by Jason Merrill.

	* Delete .vers, etc/newdist.sh, etc/newvers.sh and
	etc/nextvers.sh.  Release numbers will be edited `by hand'.
	* version.h: De-automatize, force value in.

	* m4.c: Changes in order to use a newer getopt.h.
	Reported by David MacKenzie.

	* checks/: New name for examples/.
	* checks/get_them: New location for etc/get_examples.
	* checks/check_them: New location for etc/check_examples.
	* Makefile.in, checks/get_them, checks/check_them: Adjust.
	* lib/vfprintf.c: New location for etc/vfprintf.c.
	* Delete empty etc/.
	* examples/: New name for test/.

1992-03-10  François Pinard  <pinard@iro.umontreal.ca>

	* Makefile.in (check): Add m4 as dependency.

	* m4.c: Accept --no-warnings instead of --no_warnings, and
	--no-gnu-extensions instead of --no_gnu_extensions.  Make the
	usage message more informative.
	Reported by David MacKenzie.

1992-03-09  François Pinard  <pinard@iro.umontreal.ca>

	* etc/check_examples: New name for check_examples.sh.
	* etc/get_examples: New name for get_examples.sh.
	* Makefile.in, etc/Makefile.in: Use new names.

	* Makefile.in: Transmit $(CC) while making in lib.

	* Many *.[hc] files: GNU indent'ed, with further fine tuning of
	code disposition by hand.

1992-03-08  François Pinard  <pinard@iro.umontreal.ca>

	* m4.h: Delete definitions for abort() and exit().
	Reported by Richard Stallman.

	* config/hmake-unicos, config/s-unicos.h: New files.
	Reported by Hal Peterson.

	* eval.c (exp_term): Have N^0 return 1.
	Reported by Michael Fetterman.

	* eval.c, input.c, m4.h: Remove last comma in enums.
	Reported by Mike Lijewski.

	* Transfer of maintenance duties from René to François.

1991-10-24  René Seindal <seindal@diku.dk>

	* Release 1.0.  Many thanks to those, who provided me with bug
	reports and feedback.

	* Uses GNU configure, taken from the gdb distribution.

	* Uses GNU getopt(), with long option names.

	* The -Q/+quiet option is added, which suppresses warnings about
	missing or superflous arguments to built-in macros.

	* Added default options via the M4OPTS environment variable.

	* The built-in format can now be configured to use sprintf as
	the formatting engine, for systems without [efg]cvt(3).

	* GNU library code is moved to the ./lib subdirectory; other
	utility files are now in ./etc.

	* Several minor bugs have been fixed.

1991-07-26  René Seindal <seindal@diku.dk>

	* Fixed various bugs.  Release 0.99, manual 0.09.  Many thanks to
	Francois Pinard and Roland H. Pesch for providing me with reports.

	* The builtins incr and decr are now implemented without use of
	eval.

	* The builtin indir is added, to allow for indirect macro calls
	(allows use of "illegal" macro names).

	* The debugging and tracing facilities has been enhanced
	considerably.  See the manual for details.

	* The -tMACRO option is added, marks MACRO for tracing as soon
	as it is defined.

	* Builtins are traced after renaming iff they were before.

	* Named files can now be undiverted.

	* The -Nnum option can be used to increase the number of
	divertions available.

	* Calling changecom without arguments now disables all comment
	handling.

	* The function m4_patsubst() is now consistently declared
	static.

	* A bug in dnl is fixed.

	* A bug in the multi-character quoting code is fixed.

	* Several typos in the manual has been corrected.  More probably
	persist.

	* The m4.info file is now installed along with the program.

1990-11-15  René Seindal <seindal@diku.dk>

	* Updated and enhanced version.  Release 0.75, manual 0.07.

	* Implemented search path for include files (-I option and
	M4PATH envronment variable).

	* Implemented builtin "format" for printf-like formatting.

	* Implemented builtin "regexp" for searching for regular
	expressions.

	* Implemented builtin "patsubst" for substitution with regular
	expressions.

	* Implemented builtin "esyscmd", which expands to a shell
	commands output.

	* Implemented "__file__" and "__line__" for use in error
	messages.

	* Implemented character ranges in "translit".

	* Implemented control over debugging output.

	* Implemented multi-character quotes.

	* Implemented multi-character comment delimiters.

	* Changed predefined macro "gnu" to "__gnu__".

	* Changed predefined macro "unix" to "__unix__", when the -G
	option is not used.  With -G, "unix" is still defined.

	* Changed "shift", "$@" and "$*" to not insert spaces afters
	commas.

	* Added program name to error messages.

	* Fixed two missing null bytes bugs.

1990-01-22  René Seindal <seindal@diku.dk>

	* Initial beta release.  Release 0.50, manual 0.05.
